<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <title>Asistente Preflop NL5 - 9MAX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Tu CSS -->
  <link rel="stylesheet" href="asistente.css" />
</head>

<body>
  <div class="app-shell">
    <!-- Encabezado -->
    <header class="mb-4">
      <div class="d-flex justify-content-between align-items-center mb-2"><span class="app-title">Asistente
          preflop</span> <span class="app-chip">NL5 · Mesa 9MAX · TAG explotativo</span></div>
      <h1 class="app-subtitle text-white mb-1">Asistente Preflop NL5 - 9MAX</h1>
      <p class="helper-text mb-0">Elegí posición, escenario y tu mano. El asistente consulta el JSON de rangos y sugiere
        la acción estándar (OR, call, 3bet, 4bet o fold).</p>
    </header>
    <a href="editor.html" class="btn btn-editor px-4 py-2 mb-3"> ✏️ Editor de Rangos </a>
    <div class="card-glass p-4 mb-4">
      <div class="row g-4 align-items-start">
        <!-- ======================= COLUMNA IZQUIERDA ======================= -->
        <div class="col-12 col-lg-7">
          <!-- MESA + TEXTO -->
          <section class="mb-4">
            <p class="helper-text mb-2">
              Hacé clic en <strong>HERO</strong> o <strong>VILLANO</strong> y luego en un asiento de la mesa para
              asignar la posición. Internamente sigue usando los mismos selects <code>heroPosition</code> y
              <code>villainPosition</code>.
            </p>
            <!-- Selects ocultos de posición -->
            <div class="col-md-3">
              <label for="heroPosition">Tu posición (Hero)</label>
              <select id="heroPosition" class="d-none"></select>
            </div>
            <div class="select-who">
              <button id="btnSelectHero" type="button" class="active">Seleccionar posición de HERO</button> <button
                id="btnSelectVillain" type="button">Seleccionar posición de VILLANO</button>
              <button id="btnClearPositions" type="button">Limpiar posiciones</button>
            </div>
            <div class="col-md-3" id="villainPositionGroup" style="display: none"><select id="villainPosition"
                class="d-none"></select></div>
            <div class="poker-table-wrapper">
              <div class="poker-table">
                <img src="mesa_negra.jpg" alt="Mesa de póker" class="table-bg" />
                <!-- Asientos -->
                <button type="button" class="poker-seat seat-utg" data-pos="UTG">UTG</button> <button type="button"
                  class="poker-seat seat-utg1" data-pos="UTG1">UTG1</button>
                <button type="button" class="poker-seat seat-mp" data-pos="MP">MP</button> <button type="button"
                  class="poker-seat seat-hj" data-pos="HJ">HJ</button>
                <button type="button" class="poker-seat seat-co" data-pos="CO">CO</button> <button type="button"
                  class="poker-seat seat-btn" data-pos="BTN">BTN</button>
                <button type="button" class="poker-seat seat-sb" data-pos="SB">SB</button> <button type="button"
                  class="poker-seat seat-bb" data-pos="BB">BB</button>
              </div>
            </div>
          </section>
          <!-- PANEL PRINCIPAL -->
          <div class="row g-3 align-items-end">
            <div class="scenario-block">
              <label class="form-label small-label d-block mb-1">Escenario preflop</label>

              <select id="scenario" class="d-none">
                <option value="nadie_abrió">Nadie abrió (First In)</option>
                <option value="overlimp">Overlimp / Limp tras limpers</option>
                <option value="vsOpen">Enfrentando un Open Raise</option>
                <option value="vs3bet">Enfrentando un 3bet</option>
              </select>

              <div class="scenario-row">
                <div class="scenario-tabs" id="scenarioTabs">
                  <button type="button" class="scenario-btn active" data-value="nadie_abrió">First In</button>
                  <button type="button" class="scenario-btn" data-value="overlimp">Overlimp / Iso</button>
                  <button type="button" class="scenario-btn" data-value="vsOpen">Vs Open</button>
                  <button type="button" class="scenario-btn" data-value="vs3bet">Vs 3bet</button>
                </div>

                <button id="btnCalculate" type="button" class="btn btn-primary btn-calc">CALCULAR ACCIÓN</button>
              </div>
            </div>

            <!-- Selects ocultos de cartas del héroe (los usa asistente.js) -->
            <div id="hiddenHeroSelectors" class="d-none">
              <select id="card1Rank"></select>
              <select id="card1Suit">
                <option value="s">♠</option>
                <option value="h">♥</option>
                <option value="d">♦</option>
                <option value="c">♣</option>
              </select>
              <select id="card2Rank"></select>
              <select id="card2Suit">
                <option value="s">♠</option>
                <option value="h">♥</option>
                <option value="d">♦</option>
                <option value="c">♣</option>
              </select>
            </div>
            <!-- Picker visual de cartas -->
            <section class="card-picker">
              <label class="form-label small-label d-block mb-1">Selector visual de cartas</label>
              <p class="helper-text mb-2">Elegí qué carta querés asignar (Hero, flop o turn) y luego hacé clic en una
                carta de la tabla.</p>
              <div class="card-targets">
                <button type="button" class="card-target-btn active" data-target="hero1">Hero C1</button>
                <button type="button" class="card-target-btn" data-target="hero2">Hero C2</button>
                <button type="button" class="card-target-btn" data-target="flop1">Flop 1</button>
                <button type="button" class="card-target-btn" data-target="flop2">Flop 2</button>
                <button type="button" class="card-target-btn" data-target="flop3">Flop 3</button>
                <button type="button" class="card-target-btn" data-target="turn">Turn</button>
                <button type="button" class="card-target-btn" data-target="river">River</button>

                <button id="btnClearCards" type="button" class="btn btn-secondary btn-clear-inline">Limpiar cartas y
                  escenario Preflop</button>
              </div>

              <div id="cardGrid" class="card-grid"></div>
            </section>
            <p class="helper-text mt-3 mb-0">El asistente lee el JSON de rangos (archivo
              <code>ranges-nl5-9max.json</code> o la versión editada que guardes desde el editor) y sugiere la acción
              según posición, spot y mano.</p>
          </div>
          <!-- ✅ Board Inputs (Flop + Turn + River) - oculto por ahora -->
          <section class="card-glass-soft p-4 mt-4 d-none" id="boardInputs">
            <div class="result-header">
              <div>
                <div class="result-title text-white">Board (Flop + Turn)</div>
                <div class="helper-text">Elegí las cartas del flop y del turn. El panel unificado se recalcula
                  automáticamente al apretar <strong>Calcular acción</strong> (preflop) o al cambiar cartas.</div>
              </div>
            </div>
            <!-- FLOP INPUTS -->
            <div class="row g-3 align-items-end">
              <div class="col-md-12">
                <label>Flop (cartas comunitarias)</label>
                <div class="d-flex flex-wrap gap-2">
                  <div class="d-flex gap-2">
                    <select id="flop1Rank" class="form-select sel-card"></select>
                    <select id="flop1Suit" class="form-select suit-select sel-card">
                      <option value="" selected>–</option>
                      <option value="s">♠</option>
                      <option value="h">♥</option>
                      <option value="d">♦</option>
                      <option value="c">♣</option>
                    </select>
                  </div>
                  <div class="d-flex gap-2">
                    <select id="flop2Rank" class="form-select sel-card"></select>
                    <select id="flop2Suit" class="form-select suit-select sel-card">
                      <option value="" selected>–</option>
                      <option value="s">♠</option>
                      <option value="h">♥</option>
                      <option value="d">♦</option>
                      <option value="c">♣</option>
                    </select>
                  </div>
                  <div class="d-flex gap-2">
                    <select id="flop3Rank" class="form-select sel-card"></select>
                    <select id="flop3Suit" class="form-select suit-select sel-card">
                      <option value="" selected>–</option>
                      <option value="s">♠</option>
                      <option value="h">♥</option>
                      <option value="d">♦</option>
                      <option value="c">♣</option>
                    </select>
                  </div>
                </div>
                <p class="helper-text mt-2 mb-0">Tip: si no querés usar el módulo flop todavía, dejalo como está. No
                  rompe nada.</p>
              </div>
            </div>
            <!-- TURN + RIVER -->
            <div class="border-top border-secondary mt-4 pt-3">
              <div class="row g-3 align-items-end">
                <div class="col-md-12">
                  <label>Turn (4ª carta comunitaria)</label>
                  <div class="d-flex gap-2">
                    <select id="turnRank" class="form-select sel-card"></select>
                    <select id="turnSuit" class="form-select suit-select sel-card">
                      <option value="" selected>–</option>
                      <option value="s">♠</option>
                      <option value="h">♥</option>
                      <option value="d">♦</option>
                      <option value="c">♣</option>
                    </select>
                  </div>
                  <div class="row g-2 mt-2">
                    <div class="col-12"><label class="form-label small text-secondary">River</label></div>
                    <div class="col-6">
                      <select id="riverRank" class="form-select form-select-sm">
                        <option value="">– Rango –</option>
                        <option>A</option>
                        <option>K</option>
                        <option>Q</option>
                        <option>J</option>
                        <option>T</option>
                        <option>9</option>
                        <option>8</option>
                        <option>7</option>
                        <option>6</option>
                        <option>5</option>
                        <option>4</option>
                        <option>3</option>
                        <option>2</option>
                      </select>
                    </div>
                    <div class="col-6">
                      <select id="riverSuit" class="form-select form-select-sm">
                        <option value="">– Palo –</option>
                        <option value="s">♠</option>
                        <option value="h">♥</option>
                        <option value="d">♦</option>
                        <option value="c">♣</option>
                      </select>
                    </div>
                  </div>
                  <p class="helper-text mt-2 mb-0">El resultado del turn se refleja arriba en el panel unificado.</p>
                </div>
              </div>
            </div>
          </section>
          <!-- ✅ Mantengo estos IDs escondidos (los usa asistente.js para renderUnified) -->
          <div class="d-none">
            <p id="postflopContextText"></p>
            <div id="postflopBoardText"></div>
            <span id="postflopActionBadge"></span>
            <p id="postflopExplanation"></p>
            <p id="turnContextText"></p>
            <div id="turnBoardText"></div>
            <span id="turnActionBadge"></span>
            <p id="turnExplanation"></p>
          </div>
        </div>
        <!-- ======================= COLUMNA DERECHA ======================= -->
        <div class="col-12 col-lg-5 sticky-col">
          <!-- Resumen visual -->
          <section class="card-glass-soft p-3 mb-3">
            <div class="helper-text mb-1">Vista rápida de la mano actual</div>
            <div class="result-meta mb-1">Hero: <span id="summaryHeroPos">–</span> · Villano: <span
                id="summaryVillainPos">–</span></div>
            <div class="result-meta mb-1">Mano Hero: <span id="summaryHeroHand">–</span></div>
            <div class="result-meta mb-1">Flop: <span id="summaryFlop">–</span></div>
            <div class="result-meta">Turn: <span id="summaryTurn">–</span></div>
            <div class="result-meta">River: <span id="summaryRiver">–</span></div>
          </section>
          <!-- Resultado unificado -->
          <section class="card-glass-soft p-4" id="unifiedPanel">
            <div class="result-header">
              <div>
                <div class="result-title text-white">Resultado</div>
              </div>
            </div>
            <div class="mb-2">
              <div class="unified-section-title">Preflop</div>
              <div id="u_preflop_line" class="unified-line">—</div>
              <div id="u_preflop_expl" class="unified-expl mt-1">—</div>
              <span id="u_preflop_badge" class="badge badge-check mt-2">—</span>
            </div>
            <div class="unified-divider"></div>
            <div class="mb-2">
              <div class="unified-section-title">Flop</div>
              <div id="u_flop_line" class="unified-line">—</div>
              <div id="u_flop_expl" class="unified-expl mt-1">—</div>
              <span id="u_flop_badge" class="badge badge-check mt-2">—</span>
            </div>
            <div class="unified-divider"></div>
            <div>
              <div class="unified-section-title">Turn</div>
              <div id="u_turn_line" class="unified-line">—</div>
              <div id="u_turn_expl" class="unified-expl mt-1">—</div>
              <span id="u_turn_badge" class="badge badge-check mt-2">—</span>
            </div>
            <div class="unified-divider"></div>
            <div class="mt-4">
              <div class="text-uppercase small text-secondary mb-1">RIVER</div>
              <div id="u_river_line" class="fw-semibold">Esperando turn + river.</div>
              <div id="u_river_context" class="text-secondary small mt-1">—</div>
              <span id="u_river_action" class="badge badge-check mt-2">—</span>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>
  <script type="module" src="js/table-ui.js"></script>
  <script type="module" src="js/main-v2.js"></script>
  <script type="module" src="js/postflop-smoke-ui-tests-v2.js"></script>
  <script type="module" src="js/postflop-fuzz-tests-v2.js"></script>
  <script type="module" src="js/postflop-fuzz-ui-flow-v2.js"></script>
  <script type="module" src="js/postflop-fuzz-directed-v2.js"></script>
  <script src="js/manual-tests-v2.js"></script>
  <script src="js/manual-test-runner-v2.js"></script>

</body>

</html>